# the-little-prince 프로젝트 에이전트 가이드

이 문서는 `the-little-prince` 웹 기반 텍스트 어드벤처 게임의 코드 구조와 각 파일의 역할을 설명하여, 새로운 기능 및 스토리 추가를 용이하게 하는 것을 목표로 합니다.

## 프로젝트 구조

```
/
├── main.py               # 게임 시작 및 Game 객체 생성
├── game.py               # 게임의 핵심 로직, 상태 관리, 명령어 처리
├── entity.py             # 게임 내 객체(아이템, 가방 등) 정의
├── ui.py                 # UI(DOM) 조작 및 화면 출력 담당
├── test.py               # 게임 시나리오 테스트 자동화
├── index.html            # 게임의 기본 HTML 구조
├── style.css             # 게임의 스타일 시트
├── pyscript.toml         # PyScript 설정 파일
└── assets/               # 이미지 등 정적 파일
```

## 주요 파일 설명

### `main.py`

- **역할**: 게임의 진입점(Entry Point)입니다.
- **주요 기능**:
    - `Game` 클래스의 인스턴스를 생성하여 게임을 시작합니다.
    - Python 버전 정보를 출력합니다.

### `game.py`

- **역할**: 게임의 핵심 두뇌 역할을 합니다.
- **주요 기능**:
    - 게임의 전체적인 흐름과 상태(`game_started`, `current_puzzle` 등)를 관리합니다.
    - `process_command` 함수를 통해 사용자의 입력을 파싱하고, 각 명령어에 맞는 로직을 수행합니다.
    - 아이템 획득, 조합, 사용 등 게임 내 주요 이벤트를 처리합니다.
    - 수수께끼와 퍼즐의 로직을 관리하고, 정답을 확인합니다.
    - 스토리 진행에 따른 내러티브를 출력하고, 게임의 단서(`clues`)를 관리합니다.
    - `UIManager`와 `Entity` 객체와 상호작용하며 게임 상태를 UI에 반영합니다.

### `entity.py`

- **역할**: 게임에 등장하는 모든 객체(Entity)의 청사진을 정의합니다.
- **주요 클래스**:
    - `Entity`: 모든 게임 객체의 부모 클래스입니다. `UIManager` 인스턴스를 공유하여 UI 출력을 일관되게 관리합니다.
    - `Item`: 이름, 설명, 별칭(단축어)을 가지는 아이템 클래스입니다.
    - `Bag`: `Item` 객체들을 담고 관리하는 가방 클래스입니다. 아이템 추가, 제거, 확인 등의 기능을 제공합니다.

### `ui.py`

- **역할**: 웹 페이지의 DOM(Document Object Model) 조작을 통해 사용자 인터페이스를 전담합니다.
- **주요 기능**:
    - `pyscript`를 통해 HTML 요소를 가져오고 내용을 수정합니다.
    - 내러티브, 시스템 메시지, 사용자 입력 로그 등 다양한 유형의 텍스트를 화면에 출력합니다.
    - `markdown` 라이브러리를 사용하여 텍스트에 서식을 적용합니다.
    - 수수께끼 UI, 가방 상태 표시줄 등 특정 UI 컴포넌트를 생성하고 업데이트합니다.
    - `get_josa`와 같은 유틸리티 함수를 포함하여 자연스러운 한국어 조사를 처리합니다.

### `test.py`

- **역할**: 게임의 특정 시나리오를 자동으로 테스트합니다.
- **주요 기능**:
    - `TestRunner` 클래스를 통해 정의된 명령어 시퀀스를 순차적으로 실행합니다.
    - `test1` 시퀀스는 게임 시작부터 특정 아이템 조합 및 사용까지의 과정을 테스트하여, 주요 기능이 정상적으로 작동하는지 검증합니다.
    - 개발 중 새로운 기능을 추가하거나 기존 로직을 수정했을 때, 회귀 테스트(Regression Test)를 쉽게 수행할 수 있도록 돕습니다.

## 새로운 수수께끼 및 스토리 추가 가이드

1.  **새로운 아이템 추가**:
    - `game.py`의 `INITIAL_ITEM_DATA` 딕셔너리에 새로운 아이템의 이름, 설명, 별칭을 추가합니다.
    - 또는 게임 진행 중 특정 조건 충족 시 `Item` 객체를 생성하고 `bag.add()`를 통해 가방에 추가합니다.

2.  **새로운 조합법 추가**:
    - `game.py`의 `_try_crafting` 함수에 새로운 아이템 조합 로직을 추가합니다.
    - 조합에 사용할 아이템들의 이름을 확인하고, 성공 시 기존 아이템을 제거한 뒤 새로운 아이템을 가방에 추가합니다.

3.  **새로운 수수께끼 추가**:
    - `game.py`의 `DIARY_RIDDLES` 리스트와 같은 데이터 구조에 수수께끼의 내용, 힌트, 정답을 추가합니다.
    - `_check_answer` 함수에서 해당 수수께끼를 풀고 있는지 확인하고 정답을 체크하는 로직을 구현합니다.
    - `ui.py`의 `create_puzzle` 함수를 활용하여 일관된 UI로 수수께끼를 표시할 수 있습니다.

4.  **스토리 분기 추가**:
    - `game.py`의 `process_command`나 다른 이벤트 핸들러 내에서 특정 조건을 확인하여 새로운 내러티브를 출력하거나, `current_puzzle` 상태를 변경하여 새로운 퍼즐로 유도합니다.
    - 게임의 중요한 단서나 상태는 `self.clues` 딕셔너리에 저장하여 관리합니다.
